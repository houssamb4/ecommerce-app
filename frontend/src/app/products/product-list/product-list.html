<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2 class="mb-0">Products</h2>
    <div>
      <input type="search" class="form-control d-inline-block me-2" style="width:260px" placeholder="Search products..." (input)="searchTerm = $any($event.target).value; applyFilter()">
      <button class="btn btn-primary" routerLink="/products/add">Add New</button>
    </div>
  </div>

  <div *ngIf="loading" class="text-center py-4">
    <div class="spinner-border text-primary" role="status" aria-hidden="true"></div>
    <div class="mt-2">Loading productsâ€¦</div>
  </div>

  <table *ngIf="!loading" class="table table-striped table-hover">
    <thead class="table-light">
      <tr>
        <th>Name</th>
        <th>Price (MAD)</th>
        <th>Stock</th>
        <th>Category</th>
        <th class="text-end">Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let product of filteredProducts">
        <td>{{ product.name }}</td>
        <td>{{ product.price | currency:'MAD ' }}</td>
        <td>{{ product.stock }}</td>
        <td><span class="badge bg-secondary">{{ getCategoryName(product.categoryId) }}</span></td>
        <td class="text-end">
          <button class="btn btn-outline-secondary btn-sm me-2" (click)="editProduct(product.id!)">Edit</button>
          <button class="btn btn-outline-danger btn-sm" (click)="deleteProduct(product.id!)">Delete</button>
        </td>
      </tr>
      <tr *ngIf="!loading && (!filteredProducts || filteredProducts.length === 0)">
        <td colspan="5" class="text-center text-muted">No products found.</td>
      </tr>
    </tbody>
  </table>
</div>
